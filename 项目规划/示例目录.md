

```

/phResume/

├── .github/

│   └── workflows/

│       ├── ci.yml            # CI: 运行 Go 和 Node.js 的测试

│       └── deploy.yml        # CD: 构建和推送 Docker 镜像，触发部署

│

├── backend/                  # 所有的 Go 代码（单个 Go Module）

│   ├── cmd/                  # 应用程序入口 (main.go)

│   │   ├── api/              # Gin HTTP API 服务

│   │   │   └── main.go

│   │   └── worker/           # Asynq Worker 服务

│   │       └── main.go

│   │

│   ├── internal/             # 私有应用代码，由 cmd/ 调用

│   │   ├── api/              # Gin 的路由、处理器(Handlers)、中间件

│   │   ├── worker/           # Asynq 任务的处理器(Handlers)

│   │   ├── auth/             # 认证逻辑 (JWT RS256, Refresh Tokens)

│   │   ├── config/           # Viper 配置加载逻辑

│   │   ├── database/         # GORM models 和数据库初始化 (gorm.AutoMigrate)

│   │   ├── pdf/              # 封装 go-rod 和 pdfcpu 的核心逻辑

│   │   ├── store/            # 数据库查询层 (Repository 模式)

│   │   └── tasks/            # Asynq 任务定义 (Payloads)，被 API 和 Worker 共享

│   │

│   ├── Dockerfile.api        # 用于构建 API 服务的 Dockerfile

│   ├── Dockerfile.worker     # 用于构建 Worker 服务的 Dockerfile (包含 Chromium)

│   ├── go.mod                # Go 模块依赖

│   ├── go.sum

│   └── .env.example          # 后端所需环境变量示例

│

├── frontend/                 # 所有的 Next.js/React 代码

│   ├── components/           # React 组件

│   ├── pages/                # Next.js 页面路由

│   ├── public/               # 静态资源

│   ├── styles/               # CSS/SCSS

│   ├── Dockerfile            # 用于构建前端 Nginx 静态服务或 Node 服务的 Dockerfile

│   ├── next.config.js

│   ├── package.json

│   └── .env.example          # 前端所需环境变量示例

│

├── deploy/                   # 部署和基础设施配置文件 (Infrastructure as Code)

│   ├── nginx/

│   │   └── nginx.conf        # Nginx 反向代理配置

│   │

│   ├── loki/

│   │   └── loki-config.yml   # Loki 配置文件

│   │

│   ├── promtail/

│   │   └── promtail-config.yml # Promtail 配置 (如何抓取日志)

│   │

│   ├── prometheus/

│   │   └── prometheus.yml    # Prometheus 配置 (抓取哪些 /metrics)

│   │

│   └── grafana/

│       └── provisioning/     # Grafana 的数据源和仪表盘配置文件

│

├── .gitignore                # 忽略 .env, /bin, node\_modules 等

├── docker-compose.yml        # \*\*开发环境\*\*编排 (API, Worker, Frontend, PG, Redis, MinIO)

├── docker-compose.prod.yml   # \*\*生产环境\*\*编排 (编排 API, Worker, Nginx, Loki, Prom...)

├── config.dev.yml            # Viper 读取的开发环境配置 (可选, 替代 .env)

└── README.md                 # 项目介绍、如何启动、环境变量说明等

```



-----



\### 结构设计的核心思路



1\.  \*\*`/backend` (Go Monorepo):\*\*



&nbsp;     \* 你所有的 Go 代码都在一个\*\*单独的 Go Module\*\* (`go.mod` 在 `/backend` 根目录)。

&nbsp;     \* \*\*`/cmd`\*\* 目录包含了你最终要编译的\*\*两个\*\*二进制文件：`api` (Gin) 和 `worker` (Asynq)。

&nbsp;     \* \*\*`/internal`\*\* 目录包含了所有的\*\*共享逻辑\*\*。这是此结构最大的优势：你的 `api` 和 `worker` 可以\*\*共享\*\*同一个代码库，比如 `internal/database` (GORM models) 和 `internal/tasks` (Asynq 任务定义)，这能避免大量的代码重复。

&nbsp;     \* \*\*`Dockerfile.api` 和 `Dockerfile.worker`\*\* 分离。`Dockerfile.worker` 会比较特殊，因为它需要安装 `Chromium` (`go-rod` 的依赖)。



2\.  \*\*`/frontend` (React/Next.js):\*\*



&nbsp;     \* 这是一个标准的 Next.js 目录结构，与后端完全分离。



3\.  \*\*`/deploy` (基础设施即代码):\*\*



&nbsp;     \* 你所有的\*\*配置文件\*\*（Nginx, Loki, Prometheus...）都集中存放在这里。

&nbsp;     \* 这使得你的 `docker-compose.yml` 非常干净，它只需要去 `mount` (挂载) 这些配置文件即可，例如：`volumes: - ./deploy/nginx/nginx.conf:/etc/nginx/nginx.conf`。



4\.  \*\*根目录 (Root):\*\*



&nbsp;     \* 根目录是项目的\*\*控制中心\*\*。

&nbsp;     \* `docker-compose.yml` 在这里，允许你用一个 `docker-compose up` 命令启动\*\*整个\*\*开发环境（Go API + Go Worker + Next.js + PostgreSQL + Redis + MinIO）。

&nbsp;     \* `.github/workflows` 在这里，用于你的 CI/CD 流水线。



